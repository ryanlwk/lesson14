---
alwaysApply: false
---
# Backend Development Rules

**CRITICAL: Backend Isolation**
- Only modify files within `/backend` directory
- NEVER modify frontend code, config, or dependencies
- Set working directory to `/backend` for all operations

## Tech Stack

- Python 3.13+, FastAPI, Uvicorn
- Package manager: `uv` (NEVER pip)
- Commands: `uv sync`, `uv add <package>`, `uv run <command>`
- Config: Pydantic Settings in `app/config.py`, `.env` file, CORS in `app/cors.py`

## Project Structure

```
backend/
├── main.py              # Entry point
├── pyproject.toml       # Dependencies
├── uv.lock              # Lock file
└── app/
    ├── config.py        # Settings
    ├── cors.py          # CORS
    └── routes/          # API routes
```

## Development Guidelines

**API Endpoints:**
- Prefix all endpoints with `/api`
- Define routes in `app/routes/` modules
- Use FastAPI router pattern

**Code Style:**
- **REQUIRED: Full type hints** - all parameters and return types must be annotated
- Use `typing` module for complex types (List, Dict, Optional, etc.)
- No implicit `Any` types
- Use Pydantic models for validation
- Follow PEP 8

**Running:**
- `cd backend && uv run main.py` (port 8000, auto-reload enabled)

**API Contract:**
- OpenAPI schema at `/openapi.json` (auto-generated)
- Document endpoints with FastAPI docstrings

## File Modification Rules

**MAY modify:** Files in `/backend`, `pyproject.toml`, `.env.example`
**MUST NOT modify:** `/frontend`, root `README.md`, frontend configs, `.cursor/` files

## Common Tasks

**New endpoint:**
1. Create/update route in `app/routes/`
2. Define Pydantic models with type hints
3. Implement handler with full type annotations
4. Include router in `main.py` if new file

**Dependencies:** `cd backend && uv add <package>`
**Env vars:** Add to `app/config.py`, document in `.env.example`

## Checklist

- [ ] Changes only in `/backend`
- [ ] Complete type hints (params + return types)
- [ ] Endpoints prefixed with `/api`
- [ ] Dependencies via `uv add`
- [ ] Env vars documented

## Frontend Integration

- Complete backend changes first
- Verify `/openapi.json` schema
- Inform user if frontend updates needed
- Do NOT modify frontend unless explicitly requested

## Deployment

- Entry: `main.py` (contains uvicorn runner)
- Build: `uv sync`
- Start: `uv run main.py`
- `ENV=production` disables auto-reload
- `PORT` env var (defaults to 8000)
